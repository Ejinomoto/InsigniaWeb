<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Page</title>
    <link rel="stylesheet" href="assets/css/style-product.css" />
    <!-- icon dari font awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
      integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- icon dari font awesome -->
  </head>

  <body>
    <header>
      <div class="logo-container">
        <a href="#" class="logo">
          <img src="assets/images/logo-istana.png" alt="vroom logo" />
        </a>
        <div class="header-actions">
          <span class="call-us"
            >Call us: <br />
            Free Support (012) 800-456-789</span
          >
          <a href="#" class="cart"
            ><span><i class="fa-solid fa-cart-shopping"></i></span
          ></a>
        </div>
      </div>
      <div class="hamburger" id="hamburger">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <div class="navbar-container">
        <nav id="navbar">
          <ul>
            <li><a href="index.html">HOME</a></li>
            <li><a href="catalog.html" class="active">SHOP</a></li>
            <li><a href="about-us.html">ABOUT</a></li>
            <li><a href="contact-us.html">CONTACT</a></li>
          </ul>
        </nav>
        <div class="search-bar">
          <input type="text" placeholder="Search for products..." />
        </div>
      </div>
      <div class="title-container">
        <h1>Product Detail</h1>
        <h3><a href="index.html" id="link">Home</a> / Product Detail</h3>
      </div>
    </header>
    <a href="catalog.html">
      <button class="custom-btn btn-3">
        <span><i class="fa-solid fa-caret-left"></i> Back</span>
      </button>
    </a>
    <div class="main-wrapper">
      <div class="container-p-detail">
        <div class="product-div">
          <div class="product-div-left">
            <div class="img-product-container img-container">
              <img id="product-image" src="" alt="product image" />
            </div>
            <div class="hover-container" id="gallery-container"></div>
          </div>
          <div class="product-div-right">
            <span id="product-name" class="product-nama" style="color: #1d293f"></span>
            <span id="product-original" class="product-disc" style="color: #e32a2ae2; text-decoration: line-through; margin-bottom: 10px"></span>
            <span id="product-price" class="product-harga" style="color: #1d293f"></span>
            <div id="product-rating" class="product-rate" style="color: #1d293f"></div>
            <p class="product-desc" style="color: #1d293f" id="product-desc"></p>
            <div type="button" class="btn-groups">
              <button class="add-cart-btn"><i class="fas fa-shopping-cart"></i> Add to Cart</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const productData = JSON.parse(localStorage.getItem("selectedProduct"));
        const confirmationModal = document.getElementById("confirmation-modal");
        const modalProductName = document.getElementById("modal-product-name");
        const closeModal = document.getElementById("close-modal");
        const continueShoppingButton = document.getElementById("continue-shopping");
        const viewCartButton = document.getElementById("view-cart");

        // Check if product data exists
        if (productData) {
          // Populate product details
          document.getElementById("product-name").textContent = productData.name;
          document.getElementById("product-desc").textContent = productData.desc;
          document.getElementById("product-original").textContent = productData.original;
          document.getElementById("product-price").textContent = productData.price;
          document.getElementById("product-image").src = productData.image;

          // Generate product rating
          let ratingHtml = "";
          for (let i = 0; i < Math.floor(productData.rating); i++) {
            ratingHtml += '<span class="fas fa-star"></span>';
          }
          for (let i = 0; i < 5 - Math.floor(productData.rating); i++) {
            ratingHtml += '<span class="far fa-star"></span>';
          }
          document.getElementById("product-rating").innerHTML = ratingHtml;

          // Handle product gallery
          const galleryContainer = document.getElementById("gallery-container");
          if (productData.gallery && productData.gallery.length > 0) {
            productData.gallery.forEach((mediaSrc, index) => {
              const divElement = document.createElement("div");

              if (mediaSrc.includes("youtube.com") || mediaSrc.includes("youtu.be")) {
                const iframeElement = document.createElement("iframe");
                const videoId = mediaSrc.split("v=")[1] || mediaSrc.split("/")[3];
                iframeElement.src = `https://www.youtube.com/embed/${videoId}?controls=0`;
                iframeElement.classList.add("gallery-video");
                divElement.appendChild(iframeElement);
              } else if (mediaSrc.endsWith(".mp4")) {
                const videoElement = document.createElement("video");
                videoElement.src = mediaSrc;
                videoElement.width = 350;
                videoElement.controls = false;
                videoElement.classList.add("gallery-video");
                divElement.appendChild(videoElement);
              } else {
                const imgElement = document.createElement("img");
                imgElement.src = mediaSrc;
                imgElement.alt = `product gallery media ${index + 1}`;
                imgElement.classList.add("gallery-image");
                divElement.appendChild(imgElement);
              }

              galleryContainer.appendChild(divElement);
            });

            // Set up hover functionality for gallery images/videos
            const allHoverElements = document.querySelectorAll(".hover-container div img, .hover-container div iframe, .hover-container div video");
            const imgContainer = document.querySelector(".img-product-container");

            allHoverElements[0].parentElement.classList.add("active");

            allHoverElements.forEach((mediaElement) => {
              mediaElement.addEventListener("mouseover", () => {
                if (mediaElement.tagName === "IMG") {
                  imgContainer.querySelector("img").src = mediaElement.src;
                } else if (mediaElement.tagName === "IFRAME") {
                  const fullSizeIframe = mediaElement.cloneNode(true);
                  fullSizeIframe.src = fullSizeIframe.src.replace("?controls=0", "");
                  fullSizeIframe.style.width = "350px";
                  fullSizeIframe.style.height = "200px";
                  imgContainer.innerHTML = fullSizeIframe.outerHTML;
                } else if (mediaElement.tagName === "VIDEO") {
                  imgContainer.innerHTML = mediaElement.outerHTML;
                }

                resetActiveMedia();
                mediaElement.parentElement.classList.add("active");
              });
            });

            function resetActiveMedia() {
              allHoverElements.forEach((media) => {
                media.parentElement.classList.remove("active");
              });
            }
          }

          // Event listener for "Add to Cart" button
          const addToCartBtn = document.querySelector(".add-cart-btn");
          addToCartBtn.addEventListener("click", function () {
            addToCart(productData);
          });
        }

        // Function to add product to the cart
        function addToCart(product) {
          let cart = JSON.parse(localStorage.getItem("cart")) || [];

          const productExists = cart.find((item) => item.id === product.id);

          if (productExists) {
            productExists.quantity += 1; // If the product already exists, increase quantity
          } else {
            product.quantity = 1; // If new product, set quantity to 1
            cart.push(product);
          }

          localStorage.setItem("cart", JSON.stringify(cart));

          modalProductName.textContent = `${product.name} has been added to your cart!`;
          confirmationModal.style.display = "block"; // Show confirmation modal
        }

        // Close the modal when the close button is clicked
        closeModal.onclick = function () {
          confirmationModal.style.display = "none";
        };

        // Close the modal when clicking outside of it
        window.onclick = function (event) {
          if (event.target === confirmationModal) {
            confirmationModal.style.display = "none";
          }
        };

        // Continue shopping button functionality
        continueShoppingButton.onclick = function () {
          confirmationModal.style.display = "none";
        };

        // View cart button functionality
        viewCartButton.onclick = function () {
          confirmationModal.style.display = "none";
          document.getElementById("cart-sidebar").classList.add("open");
        };
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const cartSidebar = document.getElementById("cart-sidebar");
        const cartButton = document.querySelector(".cart");
        const closeButton = document.getElementById("close-cart");
        const cartItemsContainer = document.getElementById("cart-items");
        const cartTotal = document.getElementById("cart-total");

        cartButton.addEventListener("click", function (e) {
          e.preventDefault();
          cartSidebar.classList.add("open");
          displayCartItems();
        });

        closeButton.addEventListener("click", function () {
          cartSidebar.classList.remove("open");
        });

        function displayCartItems() {
          let cart = JSON.parse(localStorage.getItem("cart")) || [];
          cartItemsContainer.innerHTML = "";
          let total = 0;

          if (cart.length === 0) {
            cartItemsContainer.innerHTML = "<p>Your cart is empty.</p>";
          } else {
            cart.forEach((product) => {
              const cartItem = document.createElement("div");
              cartItem.classList.add("cart-item");

              cartItem.innerHTML = `
          <img src="${product.image}" alt="${product.name}">
          <div class="cart-item-info">
            <span>${product.name}</span>
            <span>Price: ${product.price}</span>
            <span>Quantity: ${product.quantity}</span>
          </div>
          <button class="remove-item" data-id="${product.id}">&times;</button>
        `;

              cartItemsContainer.appendChild(cartItem);

              const numericPrice = parseFloat(product.price.replace(/[^0-9]/g, ""));

              total += numericPrice * product.quantity;
            });

            cartTotal.textContent = `Rp ${total.toLocaleString("id-ID")}`;
          }

          document.querySelectorAll(".remove-item").forEach((button) => {
            button.addEventListener("click", function () {
              removeFromCart(button.getAttribute("data-id"));
            });
          });
        }

        function removeFromCart(productId) {
          let cart = JSON.parse(localStorage.getItem("cart")) || [];
          cart = cart.filter((item) => item.id !== productId);
          localStorage.setItem("cart", JSON.stringify(cart));
          displayCartItems();
        }
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const checkoutSidebar = document.getElementById("checkout-sidebar");
        const checkoutButton = document.querySelector(".checkout-btn");
        const closeCheckoutButton = document.getElementById("close-checkout");
        const checkoutItemsContainer = document.getElementById("checkout-items");
        const summaryTotal = document.getElementById("summary-total");
        const checkoutForm = document.getElementById("checkout-form");

        checkoutButton.addEventListener("click", function (e) {
          e.preventDefault();
          checkoutSidebar.classList.add("open");
          displayCheckoutItems();
        });

        closeCheckoutButton.addEventListener("click", function () {
          checkoutSidebar.classList.remove("open");
        });

        function displayCheckoutItems() {
          let cart = JSON.parse(localStorage.getItem("cart")) || [];
          checkoutItemsContainer.innerHTML = "";
          let total = 0;

          if (cart.length === 0) {
            checkoutItemsContainer.innerHTML = "<p>Your cart is empty.</p>";
            summaryTotal.textContent = "Rp 0";
          } else {
            cart.forEach((product) => {
              const checkoutItem = document.createElement("div");
              checkoutItem.classList.add("checkout-item");

              checkoutItem.innerHTML = `
      <img src="${product.image}" alt="${product.name}">
      <div class="checkout-item-info">
        <span>${product.name}</span>
        <span>Price: Rp ${parseFloat(product.price).toLocaleString()}</span>
        <span>Quantity: ${product.quantity}</span>
      </div>
    `;

              checkoutItemsContainer.appendChild(checkoutItem);

              total += parseFloat(product.price) * product.quantity;
            });

            summaryTotal.textContent = `Rp ${total.toLocaleString()}`;
          }
        }

        checkoutForm.addEventListener("submit", function (e) {
          e.preventDefault();
          alert("Order confirmed! Thank you for your purchase.");

          localStorage.removeItem("cart");
          checkoutItemsContainer.innerHTML = "<p>Your cart is empty.</p>";
          summaryTotal.textContent = "Rp 0";

          checkoutSidebar.classList.remove("open");
          checkoutForm.reset();
        });
      });
    </script>

    <div id="cart-sidebar" class="cart-sidebar">
      <div class="cart-sidebar-header">
        <h2>Your Cart</h2>
        <button id="close-cart" class="close-cart-btn">&times;</button>
      </div>
      <div id="cart-items" class="cart-items"></div>
      <div class="cart-sidebar-footer">
        <h3>Total: <span id="cart-total">Rp 0</span></h3>
        <button class="checkout-btn">Proceed to Checkout</button>
      </div>
    </div>

    <div id="checkout-sidebar" class="checkout-sidebar">
      <div class="checkout-sidebar-header">
        <h2>Checkout</h2>
        <button id="close-checkout" class="close-checkout-btn">&times;</button>
      </div>
      <div id="checkout-items" class="checkout-items"></div>
      <div class="checkout-summary">
        <h3>Order Summary</h3>
        <div class="summary-total">
          <strong>Total: <span id="summary-total">Rp 0</span></strong>
        </div>
      </div>
      <div class="checkout-form">
        <h3>Your Information</h3>
        <form id="checkout-form">
          <label for="name">Full Name:</label>
          <input type="text" id="name" required />

          <label for="email">Email:</label>
          <input type="email" id="email" required />

          <label for="address">Address:</label>
          <textarea id="address" rows="3" required></textarea>

          <label for="phone">Phone Number:</label>
          <input type="tel" id="phone" required />

          <button type="submit" class="submit-checkout-btn">Confirm Order</button>
        </form>
      </div>
    </div>
    <div id="confirmation-modal" class="modal">
      <div class="modal-content">
        <span id="close-modal" class="close">&times;</span>
        <h2>Product Added to Cart</h2>
        <p id="modal-product-name"></p>
        <button id="continue-shopping" class="btn">Continue Shopping</button>
      </div>
    </div>

    <script>
      const hamburger = document.getElementById("hamburger");
      const navbar = document.getElementById("navbar");

      hamburger.addEventListener("click", function () {
        navbar.classList.toggle("active");
      });

      window.onload = function () {
        let experienceElement = document.getElementById("experience-count");
        let startValue = 0;
        let endValue = 20;
        let duration = 1000;
        let increment = endValue / (duration / 20);

        let counter = setInterval(function () {
          startValue += increment;
          if (startValue >= endValue) {
            startValue = endValue;
            clearInterval(counter);
          }
          experienceElement.textContent = Math.floor(startValue) + "+";
        }, 20);
      };
    </script>
    <footer>
      <div class="footer-container">
        <div class="footer-col">
          <img src="assets/images/logo-istana-plain.png" alt="" />
        </div>
        <div class="footer-col">
          <h4>About Us</h4>
          <p>Istana Komputer bergerak di bidang IT & Multimedia. Menyewakan perangkat untuk keperluan berbagai acara seperti seminar, pameran, meeting dan lain sebagainya. Melayani sewa harian, bulanan dan tahunan.</p>
        </div>
        <div class="footer-col">
          <h4>Menus</h4>
          <li><a href="index.html">Home</a></li>
          <li><a href="catalog.html">Shop</a></li>
          <li><a href="contact-us.html">Contact</a></li>
          <li><a href="about-us.html">About</a></li>
        </div>
        <div class="footer-col">
          <h4>Get in Touch</h4>
          <p>Phone: 0812-1084-6420</p>
          <p>Email: iskomsarananusantara@gmail.com</p>
          <p>Address: Jl.Bukti No 29 B , Kp. Makasar , Jaktim, DKI Jakarta.</p>
        </div>
        <div class="footer-col">
          <h4>Follow Us</h4>
          <ul>
            <a target="_blank" href="https://www.facebook.com/profile.php?id=100063576776044"><i class="fa-brands fa-facebook"></i></a>

            <a target="_blank" href="https://www.instagram.com/istana_komputer/"><i class="fa-brands fa-instagram"></i></a>

            <a target="_blank" href="https://x.com/komputeristana"><i class="fa-brands fa-twitter"></i></a>
          </ul>
        </div>
      </div>
      <div id="overlay" class="overlay"></div>
    </footer>
  </body>
  <script src="/assets/js/scripts.js"></script>
</html>
